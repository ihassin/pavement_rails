<head>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	<script type="text/javascript">
	  window.onload = function () {
	  	Window.map = L.map('map').setView([41.8850300,-87.6250500], 15);
	  	L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    		attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(Window.map);
			var packets = <%= @packets.to_json.html_safe %>;

			packets.forEach(function(parsedPacket){
				// var parsedPacket = JSON.parse(packet);
				var start = new L.LatLng(parsedPacket['start_location'][0], parsedPacket['start_location'][1]);
				var end   = new L.LatLng(parsedPacket['end_location'][0], parsedPacket['end_location'][1]);
				var points = [start, end];
				var roughness = parsedPacket['roughness'];
				var red = (roughness * 100) % 255;
				var green = 0;
				var blue = 255 - ((roughness * 100) % 255);
				var color = "rgb(" + red + " ," + green + "," + blue +")"; 
		  	var poly = new L.Polyline(points, {
	    		color: color,
	    		weight: 3,
	    		opacity: 0.5,
	    		smoothFactor: 1
	    	});
  	  	poly.addTo(Window.map);
			});
	  };
	</script>
</head>
<body>
	<div id="map">
		<style>
			#map {
	    	width:100%;
	    	height:100%;
			}
	</style>
	</div>
</body>